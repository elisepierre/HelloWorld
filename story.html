<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Témoignage - Hello World</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* ==============================
       1. VARIABLES & BASE
    ============================== */
    :root {
      --isima-blue-dark: #0d2c4d;
      --isima-blue-light: #005b96;
      --isima-yellow: #f3b749;
      --isima-red: #bf4b3b;
      --isima-green: #27ae60;
      --bg-color: #f8f9fa;
      --text-main: #2c3e50;
      --text-gray: #555555;
      --card-radius: 12px;
      --shadow: 0 10px 30px rgba(0,0,0,0.08);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Roboto', sans-serif; background: var(--bg-color); color: var(--text-main); line-height: 1.6; }
    h1, h2, h3 { font-family: 'Montserrat', sans-serif; }

    /* NAVBAR */
    .navbar {
      background: var(--isima-blue-dark); padding: 15px 30px; 
      display: flex; align-items: center; position: sticky; top: 0; z-index: 100;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2); height: 70px;
    }
    .btn-back { color: white; cursor: pointer; transition: 0.3s; text-decoration: none; display: flex; align-items: center; gap: 8px; font-weight: 500; }
    .btn-back:hover { color: var(--isima-yellow); transform: translateX(-5px); }
    .brand-container { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); text-align: center; }
    .brand { font-weight: 800; font-size: 1.4rem; color: white; }
    .brand span { color: var(--isima-yellow); }

    /* HEADER */
    .story-header { position: relative; height: 45vh; overflow: hidden; background: #000; }
    .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; transition: opacity 0.8s; background-size: cover; background-position: center; }
    .slide.active { opacity: 1; }
    .header-overlay { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to top, var(--isima-blue-dark) 0%, transparent 100%); z-index: 2; }
    .header-content { position: absolute; bottom: 30px; left: 0; width: 100%; z-index: 3; color: white; text-align: center; padding: 0 20px; }
    .exp-title { font-size: 2.5rem; font-weight: 800; text-transform: uppercase; }

    /* WITNESS SELECTOR */
    .witness-selector { display: flex; justify-content: center; gap: 15px; margin: -25px auto 30px; position: relative; z-index: 20; }
    .witness-tab { background: white; padding: 10px 20px; border-radius: 50px; cursor: pointer; box-shadow: var(--shadow); font-weight: 700; transition: 0.3s; display: flex; align-items: center; gap: 10px; }
    .witness-tab.active { background: var(--isima-yellow); color: var(--isima-blue-dark); transform: translateY(-3px); }

    /* ==============================
       2. MASONRY LAYOUT ENGINE
    ============================== */
    .main-container { max-width: 1200px; margin: 0 auto 60px; padding: 0 20px; }

    /* Conteneur de colonnes */
    .masonry-wrapper {
      column-count: 2; /* 2 colonnes sur desktop */
      column-gap: 25px;
      width: 100%;
    }

    /* Empêcher les cartes de se couper entre deux colonnes */
    .theme-card {
      break-inside: avoid;
      display: inline-block; /* Crucial pour le masonry */
      width: 100%;
      background: white; 
      padding: 25px; 
      border-radius: var(--card-radius); 
      box-shadow: var(--shadow);
      margin-bottom: 25px; 
      border-left: 5px solid var(--isima-blue-light);
      transition: 0.3s;
    }
    .theme-card:hover { transform: translateY(-5px); border-left-color: var(--isima-yellow); }

    .tc-header { display: flex; align-items: center; margin-bottom: 15px; }
    .tc-icon { font-size: 1.2rem; color: var(--isima-blue-dark); margin-right: 12px; }
    .tc-title { font-size: 1rem; font-weight: 800; text-transform: uppercase; color: var(--isima-blue-dark); }

    /* TEXT CLAMPING & FADE */
    .tc-content { 
      font-size: 0.95rem; 
      color: var(--text-gray); 
      position: relative;
      transition: max-height 0.5s ease;
    }
    
    .tc-content.clamped {
      max-height: 150px;
      overflow: hidden;
      /* Dégradé plus prononcé pour indiquer la suite */
      mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
      -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
    }

    .expand-btn {
      display: none;
      margin: 10px auto 0;
      background: #f0f2f5;
      border: none;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--isima-blue-light);
      cursor: pointer;
      align-items: center;
      gap: 5px;
      transition: 0.3s;
    }
    .expand-btn:hover { background: var(--isima-blue-light); color: white; }
    .expand-btn.active i { transform: rotate(180deg); }

    /* PROS & CONS */
    .pc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 10px; }
    .pc-box { padding: 15px; border-radius: 8px; font-size: 0.9rem; }
    .pc-box.pros { background: #e8f5e9; color: #2e7d32; }
    .pc-box.cons { background: #ffebee; color: #c62828; }

    /* FOOTER */
    .contact-footer { background: var(--isima-blue-dark); color: white; padding: 40px; text-align: center; border-radius: 20px; }
    .contact-btn { display: inline-flex; align-items: center; gap: 10px; padding: 10px 20px; background: rgba(255,255,255,0.1); color: white; text-decoration: none; border-radius: 50px; margin: 5px; transition: 0.3s; }
    .contact-btn:hover { background: var(--isima-yellow); color: var(--isima-blue-dark); }

    /* RESPONSIVE */
    @media (max-width: 900px) { .masonry-wrapper { column-count: 1; } .pc-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

  <nav class="navbar">
    <a href="#" class="btn-back" onclick="goBack()"><i class="fas fa-arrow-left"></i> Retour</a>
    <div class="brand-container"><div class="brand">HELLO <span>WORLD</span></div></div>
  </nav>

  <header class="story-header">
    <div class="header-overlay"></div>
    <div id="slides-container"></div>
    <div class="header-content">
      <h1 class="exp-title" id="d-title">...</h1>
      <p id="d-location"><i class="fas fa-map-marker-alt"></i> ...</p>
    </div>
  </header>

  <div class="main-container">
    <div class="witness-selector" id="tabs-container"></div>

    <div class="student-meta" style="text-align: center; margin-bottom: 30px;">
      <h2 style="font-size: 1.8rem;">Témoignage de <span id="w-name" style="color:var(--isima-blue-light)">...</span></h2>
      <p id="w-info" style="font-weight: 500; color: var(--text-gray);"></p>
    </div>

    <div class="masonry-wrapper">
      
      <div class="theme-card">
        <div class="tc-header"><i class="fas fa-passport tc-icon"></i><span class="tc-title">Administratif & Visa</span></div>
        <div class="tc-content" id="txt-visa"></div>
        <button class="expand-btn" onclick="toggleCard(this)">Voir plus <i class="fas fa-chevron-down"></i></button>
      </div>

      <div class="theme-card">
        <div class="tc-header"><i class="fas fa-home tc-icon"></i><span class="tc-title">Logement</span></div>
        <div class="tc-content" id="txt-logement"></div>
        <button class="expand-btn" onclick="toggleCard(this)">Voir plus <i class="fas fa-chevron-down"></i></button>
      </div>

      <div class="theme-card">
        <div class="tc-header"><i class="fas fa-wallet tc-icon"></i><span class="tc-title">Budget moyen</span></div>
        <div class="tc-content" id="txt-argent"></div>
        <button class="expand-btn" onclick="toggleCard(this)">Voir plus <i class="fas fa-chevron-down"></i></button>
      </div>

      <div class="theme-card">
        <div class="tc-header"><i class="fas fa-graduation-cap tc-icon"></i><span class="tc-title">Vie Universitaire</span></div>
        <div class="tc-content" id="txt-univ"></div>
        <button class="expand-btn" onclick="toggleCard(this)">Voir plus <i class="fas fa-chevron-down"></i></button>
      </div>

      <div class="theme-card">
        <div class="tc-header"><i class="fas fa-notes-medical tc-icon"></i><span class="tc-title">Santé & Pratique</span></div>
        <div class="tc-content" id="txt-sante"></div>
        <button class="expand-btn" onclick="toggleCard(this)">Voir plus <i class="fas fa-chevron-down"></i></button>
      </div>

      <div class="theme-card">
        <div class="tc-header"><i class="fas fa-star tc-icon"></i><span class="tc-title">Bilan de l'expérience</span></div>
        <div class="pc-grid">
          <div class="pc-box pros"><strong>Les +</strong><ul id="list-pros" style="padding-left:15px; margin-top:5px;"></ul></div>
          <div class="pc-box cons"><strong>Les -</strong><ul id="list-cons" style="padding-left:15px; margin-top:5px;"></ul></div>
        </div>
      </div>

      <div class="theme-card" style="border-left-color: var(--isima-yellow);">
        <div class="tc-header"><i class="fas fa-lightbulb tc-icon" style="color:var(--isima-yellow)"></i><span class="tc-title">Conseils aux arrivants</span></div>
        <div class="tc-content" id="txt-conseils"></div>
      </div>

    </div>

    <footer class="contact-footer">
      <h3>Une question pour l'étudiant ?</h3>
      <div class="contact-links" id="contact-area" style="margin-top:20px;"></div>
    </footer>
  </div>

  <script>
    // Récupération des données (Base identique à ton fichier)
    const storiesDB = {
      "taiwan-yuanze": {
        title: "Échange à Yuan Ze University",
        location: "Taoyuan, Taïwan",
        countryId: "taiwan",
        witnesses: [
          {
            name: "Elise PIERRE",
            filiere: "F1",
            dates: "Février 2026 - Juin 2026",
            type: "Échange Académique",
            avatar: "",
            images: [
              "https://images.unsplash.com/photo-1552993873-0dd1110e025f?auto=format&fit=crop&w=1600&q=80", 
              "https://images.unsplash.com/photo-1508248467877-f8278075841b?auto=format&fit=crop&w=1600&q=80"
            ],
            // EXEMPLE DE TEXTE FORMATÉ HTML
            visa: "<ul><li><b>Passeport et VISA obligatoires</b></li><li><b>Délais</b> : L'acceptation de l'école peut prendre du temps (reçue le 11 décembre 2025).</li><li><b>Billets d'avion aller-retour</b> : Nécessaire pour la demande de visa.</li><li><b>Visa</b> : Bureau de Représentation de Taipei en France (délai de traitement après réception entre 3 et 7 jours ouvrés, passeport physique requis).</li></ul>",
            logement: "Dortoirs sur le campus (économiques mais stricts)",
            argent: "<ul><li><b>Billets d'avion</b> : 975€ (aller-retour Eva Air sans escale).</li><li><b>Visa</b> : 71€ pour le Visa à Entrée Simple en délai 3 jours ouvrés.</li></ul>",
            sante: "Passeport et VISA obligatoires (si besoin, commencez vos démarches pour le passeport dès septembre si vous compter aller dans un pays hors UE)! L'acceptation de l'école prend un peu de temps, je ne l'ai reçu que le 11 décembre 2025 et nécessitera plusieurs démarches administratives (bilan santé, assurance, VISA...). Pour le VISA, nous devions présenter les billets d'avions aller-retour. À Eva Air, sans escale, les billets m'ont coûtés 974.93€, deux mois avant le départ.Enfin, j'ai pris un Visa à Entrée Simple au Bureau de Représentation de Taipei en France (sur place) qui m'a coûté 71€ pour qu'il me soit délivré en 3 jours ouvrés et non 7 (⚠ ils leur faut votre passeport physique, pas une copie).",
            telecom: "",
            quotidien: "",
            univ: "",
            conseils: "A",
            pros: [""],
            cons: [""],
            contact: { linkedin: "#", insta: "#", discord: "#", mail: "elise.pierre@isima.fr" }
          }
        ]
      },
      "canada-uqac": {
        title: "Échange à l'UQAC",
        location: "Chicoutimi, Québec",
        countryId: "canada",
        witnesses: [
          {
            name: "Thomas D.",
            filiere: "F2",
            dates: "Août 2023 - Déc 2023",
            type: "Échange",
            avatar: "https://randomuser.me/api/portraits/men/32.jpg",
            images: ["https://images.unsplash.com/photo-1433838552652-f9a46b332c40?auto=format&fit=crop&w=1600&q=80"],
            visa: "AVE suffisant (-6 mois). Coût 7$.",
            logement: "Résidence sur le campus. 350 CAD/mois. Ambiance géniale.",
            argent: "Budget 900€/mois. La vie est moins chère qu'à Montréal.",
            sante: "Assurance Desjardins obligatoire via l'UQAC.",
            telecom: "Wifi Campus + Carte prépayée pour urgences.",
            quotidien: "Beaucoup de nature, rando, soirées en résidence.",
            univ: "Cours pratiques, tutoiement des profs, projets de groupe.",
            conseils: "Louez une voiture pour explorer le fjord le week-end.",
            pros: ["Nature", "Coût vie", "Accueil"],
            cons: ["Froid", "Voiture nécessaire"],
            contact: { linkedin: "#", insta: "#", discord: "thomas#1234" }
          },
          {
            name: "Sarah",
            filiere: "F2",
            dates: "Jan 2023 - Mai 2023",
            type: "Échange",
            avatar: "", 
            images: ["https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?auto=format&fit=crop&w=1600&q=80"],
            visa: "AVE également. Attention, il fait très froid en arrivant en janvier !",
            logement: "Coloc en ville à 10min en bus.",
            argent: "Un peu plus cher en hiver à cause de l'équipement.",
            sante: "RAS, assurance UQAC.",
            telecom: "Forfait Fido.",
            quotidien: "Raquettes, ski et chocolat chaud.",
            univ: "J'ai adoré les cours de gestion de projet.",
            conseils: "Le festival des glaces est à ne pas manquer.",
            pros: ["Neige", "Sécurité"],
            cons: ["Nuit tombe tôt en hiver"],
            contact: {} 
          },
          {
              name: "Elisa",
              filiere: "F2",
              dates: "Jan 2023 - Mai 2023",
              type: "Échange",
              avatar: "", 
              images: ["https://images.unsplash.com/photo-1519178173668-2fc416dde9e7?auto=format&fit=crop&w=1600&q=80"], 
              visa: "AVE.",
              logement: "Résidence.",
              univ: "Super cours.",
              contact: {} 
          }
        ]
      },
      "canada-ubisoft": {
        title: "Stage Ubisoft",
        location: "Montréal, Québec",
        countryId: "canada",
        witnesses: [
          {
            name: "Julie M.",
            filiere: "F3 - SI",
            dates: "Sept 2023 - Jan 2024",
            type: "Stage",
            avatar: "https://randomuser.me/api/portraits/women/68.jpg",
            images: ["https://images.unsplash.com/photo-1556075798-4825dfaaf498?auto=format&fit=crop&w=1600&q=80"],
            visa: "Permis Stage Coop (EIC). Démarches longues (3 mois).",
            logement: "Plateau Mont-Royal. Cher (700 CAD) mais top.",
            argent: "Vie chère, mais indemnité de stage correcte.",
            sante: "Formulaire SE-401-Q-102 (RAMQ).",
            telecom: "Fizz (100% online).",
            quotidien: "Ville souterraine, festivals, poutine.",
            univ: "Ambiance de travail incroyable, très pro et relax.",
            conseils: "Anticipez le visa c'est le plus stressant.",
            pros: ["Ambiance", "Tech", "Ville"],
            cons: ["Hiver", "Taxes"],
            contact: { linkedin: "#", discord: "julie_dev" }
          }
        ]
      },
      "uk-bradford": {
        title: "Erasmus à Bradford",
        location: "Bradford, Royaume-Uni",
        countryId: "uk",
        witnesses: [
          {
            name: "Clément VERIN",
            filiere: "F1",
            dates: "Février 2025 - Mai 2025",
            type: "Erasmus",
            avatar: "", 
            images: ["https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?auto=format&fit=crop&w=1600&q=80"],
            visa: "Depuis le Brexit, passeport obligatoire ! Statut visiteur pour moins de 6 mois.",
            logement: "The Green (résidence étudiante) est top et écolo.",
            argent: "Comptez 800-1000£ par mois tout compris.",
            sante: "CEAM + Assurance complémentaire conseillée.",
            telecom: "Giffgaff est très populaire (carte SIM commandable avant).",
            quotidien: "Bradford est multiculturelle. Proche de Leeds.",
            univ: "Université orientée pratique. Infrastructures modernes.",
            conseils: "Prenez un bon imperméable et visitez l'Ecosse.",
            pros: ["Immersion Anglais", "Coût vs Londres", "Proximité Leeds"],
            cons: ["Météo", "Ville industrielle"],
            contact: { mail: "clement.verin@isima.fr" }
          }
        ]
      }
    };

    let currentData = null;

    function loadStory() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id');
      currentData = storiesDB[id];
      if (!currentData) return;

      document.getElementById('d-title').innerText = currentData.title;
      document.getElementById('d-location').innerHTML = `<i class="fas fa-map-marker-alt" style="color:var(--isima-yellow)"></i> ${currentData.location}`;
      window.countryBackId = currentData.countryId;

      const tabs = document.getElementById('tabs-container');
      currentData.witnesses.forEach((w, i) => {
        const btn = document.createElement('div');
        btn.className = `witness-tab ${i===0?'active':''}`;
        btn.innerHTML = `<i class="fas fa-user-circle"></i> ${w.name}`;
        btn.onclick = () => switchWitness(i);
        tabs.appendChild(btn);
      });
      switchWitness(0);
    }

    function switchWitness(index) {
      const w = currentData.witnesses[index];
      document.getElementById('w-name').innerText = w.name;
      document.getElementById('w-info').innerText = `${w.filiere} • ${w.type} • ${w.dates}`;
      
      const fields = { visa:'txt-visa', logement:'txt-logement', argent:'txt-argent', sante:'txt-sante', univ:'txt-univ', conseils:'txt-conseils' };
      Object.keys(fields).forEach(key => {
        const el = document.getElementById(fields[key]);
        el.innerHTML = w[key] || "Non renseigné.";
        el.classList.remove('clamped');
        const btn = el.parentElement.querySelector('.expand-btn');
        if(btn) btn.style.display = 'none';

        setTimeout(() => {
          if (el.scrollHeight > 150) {
            el.classList.add('clamped');
            if(btn) btn.style.display = 'flex';
          }
        }, 50);
      });

      // Pros/Cons
      const renderList = (id, list) => {
        const el = document.getElementById(id);
        el.innerHTML = "";
        list.forEach(item => el.innerHTML += `<li>${item}</li>`);
      };
      renderList('list-pros', w.pros);
      renderList('list-cons', w.cons);

      // Slider images
      const container = document.getElementById('slides-container');
      container.innerHTML = "";
      w.images.forEach((img, i) => {
        const div = document.createElement('div');
        div.className = `slide ${i===0?'active':''}`;
        div.style.backgroundImage = `url('${img}')`;
        container.appendChild(div);
      });

      // Contact
      const area = document.getElementById('contact-area');
      area.innerHTML = "";
      if(w.contact.mail) area.innerHTML += `<a href="mailto:${w.contact.mail}" class="contact-btn"><i class="fas fa-envelope"></i> Envoyer un mail</a>`;
    }

    function toggleCard(btn) {
      const content = btn.parentElement.querySelector('.tc-content');
      content.classList.toggle('clamped');
      btn.classList.toggle('active');
      btn.innerHTML = content.classList.contains('clamped') ? 'Voir plus <i class="fas fa-chevron-down"></i>' : 'Réduire <i class="fas fa-chevron-up"></i>';
    }

    function goBack() { window.location.href = `country.html?id=${window.countryBackId || ''}`; }
    document.addEventListener('DOMContentLoaded', loadStory);
  </script>
</body>
</html>


